# 分镜脚本编写指南

本文档提供专业分镜脚本的编写规范，确保生成的视频内容准确、完整、高质量。

## 分镜脚本格式

### 标准格式
```markdown
# 场景标题

- **时长**: 5秒 或 10秒（**只能是5秒或10秒**）
- **主体**: 角色1, 角色2（可选）
- **参考图**: first-frames/xxx-first-frame.png（可选，推荐使用，默认填入对应首帧图片的默认URL）

- **提示词**：包括视频内容和声音（可选）以及美学控制（可选）和风格化（可选）。
```

### 格式说明

#### 1. 时长（必需）
- ✅ **分镜时长只能是5秒或10秒**
- ❌ 不允许其他时长（如3秒、8秒、15秒等）
- 如果场景内容较长，应拆分为多个5秒或10秒的分镜

#### 2. 主体（可选）
- 列出分镜中涉及的主要角色或对象
- 格式：`角色1, 角色2`
- 如果分镜中没有固定角色，可省略

#### 3. 参考图（可选，推荐）
- **推荐使用**：使用参考图可以让生成的内容更加可控，建议优先使用
- **默认参考图**：推荐包含对应首帧图片的默认URL
- **URL格式**：`first-frames/场景名-first-frame.png`
- **示例**：`first-frames/01-opening-first-frame.png`
- **即使图片未生成**：也可以按照上述格式填入默认URL，后续生成首帧图片时会自动匹配
- **用户自定义参考图**（可选）：可额外添加 `ref-img/xxx.jpg`，用逗号分隔
- **文生视频**：如果不提供参考图，系统将使用纯文本提示词生成视频（文生视频模式）

**使用参考图 vs 不使用参考图**：
- ✅ **使用参考图**：生成内容更可控，画面更符合预期，推荐用于需要精确控制视觉效果的场景
- ⚠️ **不使用参考图**：完全依赖文本描述，生成结果可能有一定随机性，适合快速原型或创意探索

#### 4. 提示词（必需）
提示词是分镜脚本的核心，**必须是一段融合的完整描述**，将视频内容、声音（可选）、美学控制（可选）和风格化（可选）自然地融合在一起，**禁止分条列出**。

**重要约束**：
- ❌ **禁止**分条输出，如"**视频提示词**：... **声音提示词**：... **美学控制**：... **风格化**：..."
- ✅ **必须**融合成一段连贯的自然语言描述

**提示词应包含的内容**（这些内容需要自然地融合在描述中，而不是分条列出）：

**视频内容**：
- 运动描述：结合图像中的元素（如人物、动物），描述其动态过程（如奔跑、打招呼、挥手、转身、跳跃），可通过形容词控制动态程度与速度（如"快速地"、"缓慢地"、"优雅地"）
- 运镜描述：若对镜头运动有特定要求，通过提示词控制（如"镜头推进"、"镜头拉远"、"镜头向右移动"、"镜头上摇"、"手持镜头"、"跟随镜头"、"环绕运镜"、"复合运镜"）；若希望镜头固定，使用"固定镜头"来强调

**声音**（可选）：
- 人声：`"角色说话的内容"` + 情绪 + 语调 + 语速 + 音色 + 口音（如童音、方言、唱歌、Rap等）
- 音效：音源材质 + 行为 + 环境音（如脚步声、敲门声、物体坠地、撞击声、火焰燃烧声、游戏音效、电子音效、ASMR、动物声音、键盘声等）
- 背景音乐：背景音乐/配乐 + 风格 + 情绪（如情绪音乐、卡点音乐、轻音乐等）
- 环境音：自然环境（风声、鸟鸣）、城市环境（车流、人声）、特定空间（太空、水下）等

**美学控制**（可选）：
- 光源类型：日光、人工光、月光、实用光、火光、荧光、阴天光、混合光、晴天光
- 光线类型：柔光、硬光、顶光、侧光、背光、底光、边缘光、剪影、低对比度、高对比度
- 时间段：白天、夜晚、黄昏、日落、黎明、日出
- 景别：特写、近景、中景、中近景、中全景、全景、广角
- 构图：中心构图、平衡构图、右/左侧重构图、对称构图、短边构图
- 镜头：镜头焦段（中焦距、广角、长焦、望远、超广角-鱼眼）、机位角度（过肩角度、高角度、低角度、倾斜角度、航拍、俯视角度）、镜头类型（干净的单人镜头、双人镜头、三人镜头、群像镜头、定场镜头）
- 色调：暖色调、冷色调、高饱和度、低饱和度
- 动态控制：运动（街舞、跑步、滑滑板、踢足球、网球、乒乓球、滑雪、篮球、橄榄球、顶碗舞、侧手翻等）、人物情绪（愤怒、恐惧、高兴、悲伤、惊讶）

**风格化**（可选）：
- 画面风格语言：毛毡风格、3D卡通、像素风格、木偶动画、3D游戏、黏土风格、二次元、水彩画、黑白动画、油画风格、移轴摄影、延时拍摄、赛博朋克、勾线插画、废土风格等

## 完整示例

### 示例1：双人对话场景
```markdown
# 咖啡馆对话

- **时长**: 10秒
- **主体**: 男主角, 女主角
- **参考图**: first-frames/cafe-dialogue-first-frame.png

- **提示词**：双人对话，暖色调，日光，柔光，侧光，中景，中心构图，全景。红色背景的舞台铺着光滑的木质地板，两束聚光灯从上方斜射而下，照亮一对恋人。男人比女人略高，身穿剪裁合体的深灰色西装，面容清晰，眼神专注；女人身着酒红色长裙，发丝乌黑柔顺，随微风轻轻飘动。他双手轻捧她的脸颊，拇指缓缓摩挲她颧骨，她微微仰头，双眸含光，与他深情对视。她的长发被他的指尖轻轻拂过，发丝在光线中泛出细腻光泽。两人呼吸轻缓，身体随着无声的旋律微微贴近又分离，仿佛在静默中共舞。背景隐约传来柔和的钢琴前奏，音符如水流动。她轻启唇瓣，低声呢喃："这一刻，像梦一样。" 他凝视着她，回应道："但它是真的。"
```

### 示例2：动作场景
```markdown
# 跑步冲刺

- **时长**: 5秒
- **主体**: 短跑运动员
- **参考图**: first-frames/running-sprint-first-frame.png

- **提示词**：这是一个跑步的场景，一位表情因极度用力而扭曲的短跑运动员，面部肌肉紧绷，牙关紧咬，穿着轻薄的紧身田径背心和短裤，专业钉鞋，在百米赛道的终点线上，他以惊人的速度全力冲刺！身体前倾，头奋力向前探出，双臂以最大幅度和频率摆动，一条腿蹬地爆发，另一条腿大幅前迈。胸膛撞断终点线。背景是模糊的跑道和观众，计时器显示着关键时间，冲刺带清晰可见。镜头跟随运动员快速移动，捕捉冲刺瞬间。
```

### 示例3：环境音场景
```markdown
# 城市街道

- **时长**: 10秒
- **参考图**: first-frames/city-street-first-frame.png

- **提示词**：移轴镜头，中景，构图平衡。一列芝加哥"L"线列车在高架轨道上平稳滑行，穿梭于密集的城市峡谷之间。上午的阳光从空中倾泻而下，为场景带来柔和的定向光，突出了列车车厢的金属光泽，同时为相邻的摩天大楼披上一层轻柔的阴影。列车保持清晰对焦，宛如一个精心制作的微缩模型，车轮在铁轨上发出咔嗒声，驶过弯曲轨道，逐渐靠近站台。车厢内的乘客模糊成柔和的形状，带着淡淡的运动轨迹；周围的建筑物则虚化成梦幻般的焦外，窗户闪烁着冷暖色调的光芒。摄像机在轨道水平线进行横向跟随，营造出无缝的跟踪运动，强化了微缩世界的视觉错觉。背景音效包括有节奏的列车轰鸣声、远处城市的嗡嗡声、偶尔的刹车尖叫声，以及公共广播系统里模糊不清的通知声。
```

### 示例4：风格化场景
```markdown
# 魔法森林

- **时长**: 10秒
- **主体**: 精灵弓箭手
- **参考图**: first-frames/magic-forest-first-frame.png

- **提示词**：3D游戏，浮空岛的藤蔓桥在晨曦中微微摇曳，柔光与硬光交错，日出时分，混合光源透过云层洒落。镜头从中远景急速推进，穿过摇曳的藤蔓枝叶，贴近一位银发精灵弓箭手。她身姿矫健，身穿淡绿色贴身战袍，双手拉弓如满月，箭矢划破空气，带出蓝色魔法轨迹，穿透层层云雾。精灵耳部修长，眉眼冷峻，神情专注。背景为漂浮的山脉与盘旋其间的巨龙，龙翼遮蔽部分天空，增强纵深感。构图采用中心构图，航拍角度展现宏大场景，色调偏暖，光线柔和，对比分明，突出史诗氛围。背景音乐为史诗风格配乐，节奏激昂。
```

## 提示词编写技巧

### 1. 组合使用
可以将不同维度的提示词组合使用，例如同时指定：
- 光源类型 + 光线类型 + 景别 + 构图
- 运动 + 运镜 + 人物情绪 + 风格化

### 2. 细节描述
尽量详细描述画面元素：
- **人物特征**：年龄、性别、外貌、服装、表情、姿态
- **环境细节**：场景位置、背景元素、道具、装饰
- **动作节奏**：动作的速度、幅度、连贯性

### 3. 情绪表达
明确描述希望传达的情绪和氛围：
- 温馨、紧张、悲伤、兴奋、神秘、浪漫等
- 通过光线、色调、构图、音乐共同营造

### 4. 技术参数
合理使用技术术语来精确控制画面效果：
- 不要过度堆砌术语，选择最关键的参数
- 优先使用对画面影响最大的参数

### 5. 声音与画面同步
确保声音描述与画面内容匹配：
- 人声与角色动作同步
- 音效与画面动作对应
- 背景音乐与画面情绪一致

## 常见错误避免

### ❌ 错误示例1：时长不符合规范
```markdown
- **时长**: 8秒  # ❌ 错误：只能是5秒或10秒
```

### ❌ 错误示例2：提示词分条输出（禁止）
```markdown
- **提示词**：3D动画风格，圆润可爱的角色设计...

**视频提示词**：灰姑娘缓缓走向王子...

**声音提示词**：王宫舞会大厅内，悠扬的古典音乐...

**美学控制**：暖色调为主，金色和蓝色交相辉映...

**风格化**：3D卡通童话风格...
```
**说明**：❌ **禁止**这种分条输出的格式。提示词必须融合成一段完整的描述。

### ✅ 正确示例：融合成一段话
```markdown
- **提示词**：3D动画风格，圆润可爱的角色设计，灰姑娘和王子在王宫舞会大厅初次相遇。灰姑娘身着蓝色丝绸礼服，裙摆如波浪般飘逸，脚穿闪闪发光的水晶鞋。王子穿着深蓝色王室礼服，金色肩章闪闪发光。两人在水晶吊灯下相遇，灰姑娘缓缓走向王子，脚步轻盈如舞蹈，裙摆随着步伐轻柔摆动，王子优雅地弯腰行礼，伸出手邀请灰姑娘共舞。镜头缓慢推进，聚焦在两人相遇的温馨时刻，固定镜头保持稳定，突出两人眼神交流的美好瞬间。王宫舞会大厅内，悠扬的古典音乐轻柔地响起，小提琴和钢琴的合奏营造出浪漫氛围，贵族们低声的交谈声和轻轻的笑声作为背景音，灰姑娘的脚步声在大理石地面上发出轻微的"哒哒"声，水晶鞋与地面接触时发出清脆悦耳的声响。暖色调为主，金色和蓝色交相辉映，水晶吊灯提供主要光源，光线柔和而明亮，中景构图，突出两人的互动，中心构图，将灰姑娘和王子置于画面中央，背景虚化，突出主体人物，全景视角展现整个舞会大厅的华丽氛围。3D卡通童话风格，圆润可爱的角色造型，大眼睛，表情丰富，色彩鲜艳明亮，营造梦幻童话世界，材质表现突出丝绸的光泽和水晶的透明感。
```

### ✅ 示例3：不使用参考图（文生视频）
```markdown
- **时长**: 5秒
- **提示词**：一位年轻女孩在花园中缓慢地走向镜头，镜头固定不动，捕捉她优雅的步伐。暖色调，日光，柔光，侧光，中景，中心构图。背景音乐为轻柔的钢琴曲。
```
**说明**：不使用参考图时，系统将使用纯文本提示词生成视频。虽然可行，但使用参考图能让生成内容更加可控和准确。

### ❌ 错误示例4：描述过于简单
```markdown
- **提示词**：一个人在跑步  # ❌ 错误：缺少细节描述
```

### ✅ 正确示例
```markdown
- **时长**: 5秒
- **主体**: 短跑运动员
- **参考图**: first-frames/running-first-frame.png

- **提示词**：这是一个跑步的场景，一位表情因极度用力而扭曲的短跑运动员，面部肌肉紧绷，牙关紧咬，穿着轻薄的紧身田径背心和短裤，专业钉鞋，在百米赛道的终点线上，他以惊人的速度全力冲刺！身体前倾，头奋力向前探出，双臂以最大幅度和频率摆动，一条腿蹬地爆发，另一条腿大幅前迈。镜头跟随运动员快速移动，捕捉冲刺瞬间。
```

## 参考资源

- **提示词示例**：详见 `storyboard-prompt-examples.md`
- **AI规则**：详见 `AI-rules.md`
- **示例剧本**：详见 `example-script.md`

## 优先级原则

1. **描述质量** > 格式规范
2. **内容完整** > 格式完美
3. **视觉清晰** > 技术细节
